# include <RcppEigen.h>
# include <Rcpp.h>

// [[Rcpp::depends(RcppEigen)]]

Eigen::MatrixXd makeBcpp(double A, double Q, double rho) {
    Eigen::MatrixXd B;
    B.col(0) << 1- A, A, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    B.col(1) << 0, 0, (1 - rho) * A, 0, 0, 0, 0, (1 - rho) * (1 - A), 0, 0, 0, 0, rho, 0;
    B.col(2) << 0, 0, (1 - rho) * A, 0, 0, 0, 0, (1 - rho) * (1 - A), 0, 0, 0, 0, rho, 0;
    B.col(3) << 0, 0, (1 - rho) * A, 0, 0, 0, 0, (1 - rho) * (1 - A), 0, 0, 0, 0, rho, 0;
    B.col(4) << 0, 0, (1 - rho) * A, 0, 0, 0, 0, (1 - rho) * (1 - A), 0, 0, 0, 0, rho, 0;
    B.col(5) << 0, 0, (1 - rho) * A, 0, 0, 0, 0, (1 - rho) * (1 - A), 0, 0, 0, 0, rho, 0;
    B.col(6) << 0, 0, (1 - rho) * A, 0, 0, 0, 0, (1 - rho) * (1 - A), 0, 0, 0, 0, rho, 0;
    B.col(7) << (1- A) * (1 - Q), A * (1 - Q), 0, A * Q, 0, 0, 0, 0, (1 - A) * Q, 0, 0, 0, 0, 0;
    B.col(8) << (1- A) * (1 - Q), A * (1 - Q), 0, 0, A * Q, 0, 0, 0, 0, (1 - A) * Q, 0, 0, 0, 0;
    B.col(9) << (1- A) * (1 - Q), A * (1 - Q), 0, 0, 0, A * Q, 0, 0, 0, 0, (1 - A) * Q, 0, 0, 0;
    B.col(10) << (1- A) * (1 - Q), A * (1 - Q), 0, 0, 0, 0, A * Q, 0, 0, 0, 0, (1 - A) * Q, 0, 0;
    B.col(11) << (1- A) * (1 - Q), A * (1 - Q), 0, 0, 0, 0, A * Q, 0, 0, 0, 0, (1 - A) * Q, 0, 0;
    B.col(12) << 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1;
    B.col(13) << 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    return B;
}
